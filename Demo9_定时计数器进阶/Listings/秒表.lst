C51 COMPILER V9.60.0.0   ____                                                              10/09/2023 17:27:47 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE ____
OBJECT MODULE PLACED IN .\Objects\√Î±Ì.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE √Î±Ì.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\√Î±Ì
                    -.lst) TABS(2) OBJECT(.\Objects\√Î±Ì.obj)

line level    source

   1          #include <reg52.h>
   2          #define uint unsigned int
   3          #define uchar unsigned char
   4          
   5          sbit S4 = P3 ^ 3;
   6          sbit S5 = P3 ^ 2;
   7          
   8          uchar t_m = 0;
   9          uchar t_s = 0;
  10          uchar t_005s = 0;
  11          
  12          unsigned char code SMG_NoDot[18] = 
  13            {0xc0, 0xf9, 0xa4, 0xb0, 0x99, 0x92, 0x82, 0xf8, 
  14             0x80, 0x90, 0x88, 0x83, 0xc6, 0xa1, 0x86, 0x8e,
  15             0xbf, 0x7f};
  16          
  17          void HC138(uchar channel)
  18          {
  19   1        switch(channel)
  20   1        {
  21   2          case 4:
  22   2            P2 = (P2 & 0x1f) | 0x80;
  23   2          break;
  24   2          case 5:
  25   2            P2 = (P2 & 0x1f) | 0xa0;
  26   2          break;
  27   2          case 6:
  28   2            P2 = (P2 & 0x1f) | 0xc0;
  29   2          break;
  30   2          case 7:
  31   2            P2 = (P2 & 0x1f) | 0xe0;
  32   2          break;
  33   2        }
  34   1      }
  35          
  36          void DisplaySMG_Bit(uchar value, uchar pos)
  37          {
  38   1        HC138(6);
  39   1        P0 = 0x01 << pos;
  40   1        HC138(7);
  41   1        P0 = value;
  42   1      }
  43          
  44          void DelaySMG(uint t)
  45          {
  46   1        while (t -- ) ;
  47   1      }
  48          
  49          void DisplayTime()
  50          {
  51   1        DisplaySMG_Bit(SMG_NoDot[t_005s % 10], 7);
  52   1        DelaySMG(500);
  53   1        DisplaySMG_Bit(SMG_NoDot[t_005s / 10], 6);
  54   1        DelaySMG(500);
C51 COMPILER V9.60.0.0   ____                                                              10/09/2023 17:27:47 PAGE 2   

  55   1        DisplaySMG_Bit(SMG_NoDot[16], 5);
  56   1        DelaySMG(500);
  57   1        
  58   1        DisplaySMG_Bit(SMG_NoDot[t_s % 10], 4);
  59   1        DelaySMG(500);
  60   1        DisplaySMG_Bit(SMG_NoDot[t_s / 10], 3);
  61   1        DelaySMG(500);
  62   1        DisplaySMG_Bit(SMG_NoDot[16], 2);
  63   1        DelaySMG(500);
  64   1        
  65   1        DisplaySMG_Bit(SMG_NoDot[t_m % 10], 1);
  66   1        DelaySMG(500);
  67   1        DisplaySMG_Bit(SMG_NoDot[t_m / 10], 0);
  68   1        DelaySMG(500);
  69   1      }
  70          
  71          //===========ÂÆöÊó∂Âô®Áõ∏ÂÖ≥ÂáΩÊï∞=================
  72          // ÂÆöÊó∂Âô®ÂàùÂßãÂåñÂíåÂêØÂä®
  73          void InitTimer0()
  74          {
  75   1        TMOD = 0x01;
  76   1        TH0 = (65535 - 50000) / 256;
  77   1        TL0 = (65535 - 50000) % 256;
  78   1        
  79   1        ET0 = 1;
  80   1        EA = 1;
  81   1        TR0 = 1;
  82   1      }
  83          
  84          // ÂÆöÊó∂Âô®‰∏≠Êñ≠ÂáΩÊï∞
  85          void ServiceTimer0() interrupt 1
  86          {
  87   1        TH0 = (65535 - 50000) / 256;
  88   1        TL0 = (65535 - 50000) % 256;
  89   1        
  90   1        t_005s ++ ;
  91   1        if (t_005s == 20)
  92   1        {
  93   2          t_s ++ ;
  94   2          t_005s = 0;
  95   2          if (t_s == 60)
  96   2          {
  97   3            t_m ++ ;
  98   3            t_s = 0;
  99   3          }
 100   2          if (t_m == 99)
 101   2          {
 102   3            t_m = 0;
 103   3          }
 104   2        }
 105   1      }
 106          //==========================================
 107          
 108          
 109          //===========ÊåâÈîÆÁõ∏ÂÖ≥ÂáΩÊï∞=================
 110          // ÊåâÈîÆÂéªÊäñÂä®
 111          void DelayK(uchar t) 
 112          {
 113   1        while (t -- ) ;
 114   1      }
 115          
 116          // ÊåâÈîÆÊâ´Êèè
C51 COMPILER V9.60.0.0   ____                                                              10/09/2023 17:27:47 PAGE 3   

 117          void ScanKeys()
 118          {
 119   1        // ÁßíË°®ÂêØÂä®‰∏éÊöÇÂÅú
 120   1        if (S4 == 0)
 121   1        {
 122   2          DelayK(100);
 123   2          if (S4 == 0)
 124   2          {
 125   3            TR0 = ~TR0;
 126   3            while (S4 == 0)
 127   3            {
 128   4              DisplayTime();
 129   4            }
 130   3          }
 131   2        }
 132   1        
 133   1        // ÁßíË°®Ê∏ÖÈõ∂
 134   1        if (S5 == 0)
 135   1        {
 136   2          DelayK(100);
 137   2          if (S5 == 0)
 138   2          {
 139   3            t_m = 0;
 140   3            t_s = 0;
 141   3            t_005s = 0;
 142   3            while (S5 == 0)
 143   3            {
 144   4              DisplayTime();
 145   4            }
 146   3          }
 147   2        }
 148   1      }
 149          //==========================================
 150          
 151          void InitSystem()
 152          {
 153   1        HC138(4);
 154   1        P0 = 0xff;
 155   1      }
 156          
 157          void main()
 158          {
 159   1        InitSystem();
 160   1        InitTimer0();
 161   1        while (1)
 162   1        {
 163   2          DisplayTime();
 164   2          ScanKeys();
 165   2        }
 166   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    331    ----
   CONSTANT SIZE    =     18    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      3    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
